{"version":3,"file":"my_datatables.min.js","sources":["../src/my_datatables.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * TODO describe module my_datatables\n *\n * @module     local_message/my_datatables\n * @copyright  2024 LMSCloud.io\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\nimport Ajax from \"core/ajax\";\nimport $ from \"jquery\";\nimport \"local_message/datatables\";\nimport Templates from \"core/templates\";\nimport ModalFactory from \"core/modal_factory\";\nimport ModalEvents from \"core/modal_events\";\n\nconst selectors = {\n  actions: {\n    star: '[data-action=\"star\"]',\n    mymodal: '[data-action=\"my_modal\"]',\n  },\n};\nexport const init = () => {\n  $(function() {\n    $(\"#viewmsgtable\").DataTable({\n      bLengthChange: false,\n      ordering: false,\n    });\n  });\n  $(function() {\n    $(\".mytable\").DataTable({\n      bLengthChange: false,\n      ordering: false,\n    });\n  });\n  document.addEventListener(\"click\", (e) => {\n    let starred = e.target.closest(selectors.actions.star);\n    if (starred) {\n      var isfav = starred.getAttribute(\"data-favorited\") === \"true\";\n      var id = starred.getAttribute(\"data-id\");\n      var params = {};\n      if (isfav) {\n        params.fav = false;\n        params.id = id;\n      } else {\n        params.fav = true;\n        params.id = id;\n      }\n      var promise = Ajax.call([\n        {\n          methodname: \"local_message_favourites\",\n          args: params,\n        },\n      ]);\n      promise[0]\n        .done(function() {\n          // Success.\n          window.location.reload(true);\n        })\n        .fail(function() {\n          // Failed.\n        });\n    }\n    let mymodal = e.target.closest(selectors.actions.mymodal);\n    if (mymodal) {\n      const myObject = mymodal.getAttribute(\"data-object\");\n      const data = JSON.parse(myObject);\n      ModalFactory.create({\n        title: \"View Messages\",\n        body: Templates.render(\"local_message/viewmsg\", data),\n      }).done(function(modal) {\n        modal.setLarge();\n        modal.getRoot().on(ModalEvents.hidden, function(e) {\n          e.preventDefault();\n          window.location.reload(true);\n        });\n        modal.show();\n      });\n    }\n  });\n};\n"],"names":["_interopRequireDefault","obj","__esModule","default","_ajax","_jquery","_templates","_modal_factory","_modal_events","selectors","star","mymodal","_exports","init","$","DataTable","bLengthChange","ordering","document","addEventListener","e","starred","target","closest","isfav","getAttribute","id","params","fav","Ajax","call","methodname","args","done","window","location","reload","fail","myObject","data","JSON","parse","ModalFactory","create","title","body","Templates","render","modal","setLarge","getRoot","on","ModalEvents","hidden","preventDefault","show"],"mappings":"iPA2B4C,SAAAA,uBAAAC,YAAAA,KAAAA,IAAAC,WAAAD,KAAAE,QAAAF;;;;;;;kFAL5CG,MAAAJ,uBAAAI,OACAC,QAAAL,uBAAAK,SAEAC,WAAAN,uBAAAM,YACAC,eAAAP,uBAAAO,gBACAC,cAAAR,uBAAAQ,eAEA,MAAMC,kBACK,CACPC,KAAM,uBACNC,QAAS,4BA6DXC,SAAAC,KA1DkBA,MAClB,EAAAC,kBAAE,YACA,EAAAA,iBAAE,iBAAiBC,UAAU,CAC3BC,eAAe,EACfC,UAAU,QAGd,EAAAH,kBAAE,YACA,EAAAA,iBAAE,YAAYC,UAAU,CACtBC,eAAe,EACfC,UAAU,OAGdC,SAASC,iBAAiB,SAAUC,IAClC,IAAIC,QAAUD,EAAEE,OAAOC,QAAQd,kBAAkBC,MACjD,GAAIW,QAAS,CACX,IAAIG,MAAmD,SAA3CH,QAAQI,aAAa,kBAC7BC,GAAKL,QAAQI,aAAa,WAC1BE,OAAS,GACTH,OACFG,OAAOC,KAAM,EACbD,OAAOD,GAAKA,KAEZC,OAAOC,KAAM,EACbD,OAAOD,GAAKA,IAEAG,cAAKC,KAAK,CACtB,CACEC,WAAY,2BACZC,KAAML,UAGF,GACLM,MAAK,WAEJC,OAAOC,SAASC,QAAO,MAExBC,MAAK,eAIV,IAAI1B,QAAUS,EAAEE,OAAOC,QAAQd,kBAAkBE,SACjD,GAAIA,QAAS,CACX,MAAM2B,SAAW3B,QAAQc,aAAa,eAChCc,KAAOC,KAAKC,MAAMH,UACxBI,uBAAaC,OAAO,CAClBC,MAAO,gBACPC,KAAMC,mBAAUC,OAAO,wBAAyBR,QAC/CN,MAAK,SAASe,OACfA,MAAMC,WACND,MAAME,UAAUC,GAAGC,sBAAYC,QAAQ,SAASjC,GAC9CA,EAAEkC,iBACFpB,OAAOC,SAASC,QAAO,MAEzBY,MAAMO,aAGV,CACF"}